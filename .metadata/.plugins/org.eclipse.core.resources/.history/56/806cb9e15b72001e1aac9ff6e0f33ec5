package com.myWeb.www.service;

import java.util.List;

import javax.inject.Inject;

import org.springframework.stereotype.Service;

import com.myWeb.www.controller.BoardDTO;
import com.myWeb.www.domain.boardVO;
import com.myWeb.www.domain.fileVO;
import com.myWeb.www.domain.pagingVO;
import com.myWeb.www.repository.BoardDAO;

import lombok.extern.slf4j.Slf4j;

@Service
@Slf4j
public class BoardServiceImpl implements BoardService
{
	@Inject
	private BoardDAO bdao;

	@Override
	public int register(boardVO bvo) {
		
		return bdao.register(bvo);
	}

	@Override
	public List<boardVO> getList() {
		
		return bdao.getList();
	}

	@Override
	public boardVO getDetail(int bno) {
		
		return bdao.getDetail(bno);
	}

	@Override
	public int postModify(boardVO bvo) {
		
		return bdao.postModify(bvo);
	}

	@Override
	public int getRemove(int bno) {
		
		return bdao.getRemove(bno);
	}

	@Override
	public void readCountUp(int bno) {
		bdao.readCountUp(bno);
		
	}

	@Override
	public List<boardVO> getPageList(pagingVO pgvo) {
		
		return bdao.getPageList(pgvo);
	}

	@Override
	public int getTotalCount(pagingVO pgvo) {
		return bdao.getTotalCount(pgvo);
	}

	@Override
	public int insert(BoardDTO boardDTO) 
	{
		//bvo,flist 가져와서 각자 db에 저장
		//기존 메서드 활용
		int isOk=bdao.register(boardDTO.getBvo());// bno 등록
		
		//bvo insert 후, 파일도 있다면
		if(isOk>0 && boardDTO.getFlist().size()>0)
		{
			long bno= bdao.selectOneBno();//가장 마지막에 등록된 bno
			//모든파일에 bno 세팅
			for(fileVO fvo:boardDTO.getFlist())
			{
				fvo.setBno(bno);
				isOk*=bdao.insertFile(fvo);
			}
		}
		return 0;
	}


}
